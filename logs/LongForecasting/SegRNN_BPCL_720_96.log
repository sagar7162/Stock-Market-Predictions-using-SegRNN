Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='BPCL_720_96', model='SegRNN', data='custom', root_path='./dataset/', data_path='BPCL.csv', features='MS', target='Close', freq='d', checkpoints='./checkpoints/', seq_len=720, label_len=0, pred_len=96, rnn_type='rnn', dec_way='pmf', seg_len=48, win_len=48, channel_id=1, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=9, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.5, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=10, learning_rate=0.001, des='test', loss='mae', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 2899
val 436
test 966
Epoch: 1 cost time: 10.76538610458374
Epoch: 1, Steps: 11 | Train Loss: 0.4648809 Vali Loss: 0.6440545 Test Loss: 0.3852040
Validation loss decreased (inf --> 0.644055).  Saving model ...
Updating learning rate to 0.001
Epoch: 2 cost time: 9.285711765289307
Epoch: 2, Steps: 11 | Train Loss: 0.5001060 Vali Loss: 0.6591261 Test Loss: 0.4066329
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.001
Epoch: 3 cost time: 10.990304470062256
Epoch: 3, Steps: 11 | Train Loss: 0.4619090 Vali Loss: 0.6544866 Test Loss: 0.4086900
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.001
Epoch: 4 cost time: 9.171815633773804
Epoch: 4, Steps: 11 | Train Loss: 0.4127989 Vali Loss: 0.6991680 Test Loss: 0.3595878
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0008
Epoch: 5 cost time: 8.837802171707153
Epoch: 5, Steps: 11 | Train Loss: 0.3711510 Vali Loss: 0.6699302 Test Loss: 0.3824596
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.0006400000000000002
Epoch: 6 cost time: 8.883339643478394
Epoch: 6, Steps: 11 | Train Loss: 0.3358872 Vali Loss: 0.7073905 Test Loss: 0.3678135
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.0005120000000000001
Epoch: 7 cost time: 9.349140167236328
Epoch: 7, Steps: 11 | Train Loss: 0.3090473 Vali Loss: 0.7223157 Test Loss: 0.3614011
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.0004096000000000001
Epoch: 8 cost time: 11.078068971633911
Epoch: 8, Steps: 11 | Train Loss: 0.2879991 Vali Loss: 0.7389946 Test Loss: 0.3660322
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.0003276800000000001
Epoch: 9 cost time: 9.640140056610107
Epoch: 9, Steps: 11 | Train Loss: 0.2751184 Vali Loss: 0.7265839 Test Loss: 0.3652928
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.0002621440000000001
Epoch: 10 cost time: 9.852572679519653
Epoch: 10, Steps: 11 | Train Loss: 0.2651170 Vali Loss: 0.8026987 Test Loss: 0.3691293
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.0002097152000000001
Epoch: 11 cost time: 10.24579119682312
Epoch: 11, Steps: 11 | Train Loss: 0.2564477 Vali Loss: 0.7689319 Test Loss: 0.3815869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 966
mse:0.29055267572402954, mae:0.3907284140586853, ms/sample:2.0253389271643343
