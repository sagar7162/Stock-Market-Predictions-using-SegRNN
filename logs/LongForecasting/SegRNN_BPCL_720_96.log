Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='BPCL_720_96', model='SegRNN', data='custom', root_path='./dataset/', data_path='BPCL.csv', features='MS', target='Close', freq='d', checkpoints='./checkpoints/', seq_len=720, label_len=0, pred_len=96, rnn_type='rnn', dec_way='pmf', seg_len=48, win_len=48, channel_id=1, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=9, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.5, embed='timeF', activation='gelu', output_attention=False, do_predict=True, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=1, learning_rate=0.001, des='test', loss='mae', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 2899
val 436
test 966
train steps: 11
Epoch: 1 cost time: 12.874820470809937
Epoch: 1, Steps: 11 | Train Loss: 0.4648809 Vali Loss: 0.6440545 Test Loss: 0.3852040
Validation loss decreased (inf --> 0.644055).  Saving model ...
Updating learning rate to 0.001
Epoch: 2 cost time: 14.251026153564453
Epoch: 2, Steps: 11 | Train Loss: 0.5001060 Vali Loss: 0.6591261 Test Loss: 0.4066329
EarlyStopping counter: 1 out of 1
Early stopping
>>>>>>>testing : BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 966
Successfully extracted 1061 dates for visualization
mse:0.29055267572402954, mae:0.3907284140586853, ms/sample:4.788958508035411
Global scaling factor: 0.6726
Saved stock price predictions to ./results/BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0/stock_predictions.csv
>>>>>>>predicting : BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
pred 1
Saved future predictions to ./results/BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0/future_predictions.csv
Saved future prediction plot to ./results/BPCL_720_96_SegRNN_custom_ftMS_sl720_pl96_dm512_dr0.5_rtrnn_dwpmf_sl48_mae_test_0/future_prediction_plot.pdf
